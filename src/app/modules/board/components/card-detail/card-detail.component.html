<div mat-dialog-card-header>
  <!-- Tags -->
  <div class="row">
    <!-- Card Selected Tags -->
    <div class="col-12 d-flex align-items-center">
      <button
        mat-icon-button
        class="add-tags mr-3"
        (click)="displayTags = !displayTags"
      >
        <mat-icon class="tag-label" [class.rotate90]="displayTags"
          >label</mat-icon
        >Tags
      </button>
      <div class="selected-tags d-flex align-items-center">
        <span
          *ngFor="let tag of data.card.tags"
          style="zoom: 0.4"
          [class]="'mx-2 rounded-pill border border-dark badge ' + tag.color"
        >
          <span *ngIf="tag.title" class="mat-h1 p-3" style="line-height: 1.6">{{
            tag.title
          }}</span>
          <button mat-icon-button (click)="removeTagFromCard(tag.id)">
            <mat-icon>clear</mat-icon>
          </button>
        </span>
      </div>
    </div>

    <!-- All Available Tags -->
    <div
      class="col-12 d-flex align-items-center my-3 available-tags-container"
      [class.on-display]="displayTags"
    >
      <span
        *ngFor="let tag of tags"
        [class]="'d-flex align-items-center app-tag badge mx-1 ' + tag.color"
      >
        <span
          contenteditable
          class="w-75"
          (keydown.enter)="$event.target.blur(); saveTag(tag); (false)"
          (blur)="saveTag(tag)"
          (input)="tag.title = $event.target.textContent"
          [textContent]="tag?.title"
        ></span>
        <button
          style="zoom: 0.6"
          mat-icon-button
          type="button"
          (click)="addTagToCard(tag)"
          [disabled]="isTagAdded(tag.id)"
        >
          <mat-icon>add</mat-icon>
        </button>
      </span>
    </div>
  </div>
</div>

<!-- Card Content -->
<div mat-dialog-content>
  <div mat-dialog-title>Title</div>
  <form [formGroup]="cardForm">
    <!-- Card Title -->
    <mat-form-field class="w-100">
      <mat-label>Card Title</mat-label>
      <textarea
        matInput
        formControlName="title"
        placeholder="What is your idea ?"
      ></textarea>
    </mat-form-field>

    <!-- Card Comments -->
    <div mat-dialog-title>All Comments</div>
  </form>
  <mat-form-field class="w-100">
    <mat-label>Add A Comment</mat-label>
    <textarea
      class="new-comment"
      rows="3"
      matInput
      name="newComment"
      [(ngModel)]="newComment"
      placeholder="Is there any question ?"
      (focus)="onNewComment = true"
    ></textarea>
  </mat-form-field>
  <button
    *ngIf="onNewComment"
    mat-raised-button
    class="mx-1"
    [disabled]="!newComment || newComment.trim().length === 0"
    (click)="addComment()"
  >
    Add Comment
  </button>
  <button
    [class.d-none]="!onNewComment"
    mat-button
    type="button"
    class="mb-2 mx-1"
    (click)="onNewComment = false; newComment = ''"
  >
    Cancel
  </button>

  <!-- Comments List -->
  <div *ngFor="let comment of data.card.comments" class="my-2">
    <app-comment [comment]="comment"></app-comment>
  </div>
</div>

<!-- Actions -->
<div mat-dialog-actions class="d-flex">
  <button mat-button (click)="onClose()" class="ml-auto">Close</button>
  <button
    mat-raised-button
    color="accent"
    [mat-dialog-close]="cardForm.value"
    cdkFocusInitial
    [disabled]="cardForm.invalid"
  >
    Save
  </button>
</div>
